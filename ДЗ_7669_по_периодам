ВЫБРАТЬ РАЗЛИЧНЫЕ
	_ГрафикПогашенияПоСудебнымДелам.ДоговорКонтрагента
ПОМЕСТИТЬ ВТ_СписокДоговоров
ИЗ
	Документ._ГрафикПогашенияПоСудебнымДелам КАК _ГрафикПогашенияПоСудебнымДелам
ГДЕ
	_ГрафикПогашенияПоСудебнымДелам.Проведен = ИСТИНА
//	И _ГрафикПогашенияПоСудебнымДелам.ДоговорКонтрагента = &Договор
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	_ГрафикПогашенияПоСудебнымДеламГрафик.Ссылка,
	_ГрафикПогашенияПоСудебнымДеламГрафик.Ссылка.ДоговорКонтрагента КАК Договор,
	_ГрафикПогашенияПоСудебнымДеламГрафик.Период,
	СУММА(_ГрафикПогашенияПоСудебнымДеламГрафик.ОсновнойДолгУплата + _ГрафикПогашенияПоСудебнымДеламГрафик.ПроцентыУплата) КАК Сумма
ПОМЕСТИТЬ ВТ_ГрафикПогашения
ИЗ
	Документ._ГрафикПогашенияПоСудебнымДелам.График КАК _ГрафикПогашенияПоСудебнымДеламГрафик
ГДЕ
	_ГрафикПогашенияПоСудебнымДеламГрафик.Ссылка.ДоговорКонтрагента В
			(ВЫБРАТЬ
				ВТ_СписокДоговоров.ДоговорКонтрагента
			ИЗ
				ВТ_СписокДоговоров)
	И _ГрафикПогашенияПоСудебнымДеламГрафик.Ссылка.Проведен = ИСТИНА

СГРУППИРОВАТЬ ПО
	_ГрафикПогашенияПоСудебнымДеламГрафик.Ссылка,
	_ГрафикПогашенияПоСудебнымДеламГрафик.Ссылка.ДоговорКонтрагента,
	_ГрафикПогашенияПоСудебнымДеламГрафик.Период

ИМЕЮЩИЕ
	СУММА(_ГрафикПогашенияПоСудебнымДеламГрафик.ОсновнойДолгУплата + _ГрафикПогашенияПоСудебнымДеламГрафик.ПроцентыУплата) <> 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	_ГрафикПогашенияПоСудебнымДеламГрафик.Ссылка.ДоговорКонтрагента КАК Договор,
	СУММА(_ГрафикПогашенияПоСудебнымДеламГрафик.ОсновнойДолгНачисление + _ГрафикПогашенияПоСудебнымДеламГрафик.ПроцентыНачисление) КАК Сумма
ПОМЕСТИТЬ ВТ_ГрафикНачисления
ИЗ
	Документ._ГрафикПогашенияПоСудебнымДелам.График КАК _ГрафикПогашенияПоСудебнымДеламГрафик
ГДЕ
	_ГрафикПогашенияПоСудебнымДеламГрафик.Ссылка.ДоговорКонтрагента В
			(ВЫБРАТЬ
				ВТ_СписокДоговоров.ДоговорКонтрагента
			ИЗ
				ВТ_СписокДоговоров)
	И _ГрафикПогашенияПоСудебнымДеламГрафик.Ссылка.Проведен = ИСТИНА
	И _ГрафикПогашенияПоСудебнымДеламГрафик.Период < &ДатаОтчета

СГРУППИРОВАТЬ ПО
	_ГрафикПогашенияПоСудебнымДеламГрафик.Ссылка.ДоговорКонтрагента

ИМЕЮЩИЕ
	СУММА(_ГрафикПогашенияПоСудебнымДеламГрафик.ОсновнойДолгНачисление + _ГрафикПогашенияПоСудебнымДеламГрафик.ПроцентыНачисление) <> 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ГрафикПогашения.Договор,
	СУММА(ВЫБОР
			КОГДА ВТ_ГрафикПогашения.Период <= ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, -36)
				ТОГДА ВТ_ГрафикПогашения.Сумма
			ИНАЧЕ 0
		КОНЕЦ) КАК График_Более3ЛетПрошл,
	СУММА(ВЫБОР
			КОГДА ВТ_ГрафикПогашения.Период > ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, -36)
					И ВТ_ГрафикПогашения.Период <= ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, -12)
				ТОГДА ВТ_ГрафикПогашения.Сумма
			ИНАЧЕ 0
		КОНЕЦ) КАК График_1_3ГодаПрошл,
	СУММА(ВЫБОР
			КОГДА ВТ_ГрафикПогашения.Период > ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, -12)
					И ВТ_ГрафикПогашения.Период <= ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, -6)
				ТОГДА ВТ_ГрафикПогашения.Сумма
			ИНАЧЕ 0
		КОНЕЦ) КАК График_6_12МесПрошл,
	СУММА(ВЫБОР
			КОГДА ВТ_ГрафикПогашения.Период > ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, -6)
					И ВТ_ГрафикПогашения.Период <= ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, -3)
				ТОГДА ВТ_ГрафикПогашения.Сумма
			ИНАЧЕ 0
		КОНЕЦ) КАК График_3_6МесПрошл,
	СУММА(ВЫБОР
			КОГДА ВТ_ГрафикПогашения.Период > ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, -3)
					И ВТ_ГрафикПогашения.Период <= ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, -1)
				ТОГДА ВТ_ГрафикПогашения.Сумма
			ИНАЧЕ 0
		КОНЕЦ) КАК График_1_3МесПрошл,
	СУММА(ВЫБОР
			КОГДА ВТ_ГрафикПогашения.Период > ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, -1)
					И ВТ_ГрафикПогашения.Период <= &ДатаОтчета
				ТОГДА ВТ_ГрафикПогашения.Сумма
			ИНАЧЕ 0
		КОНЕЦ) КАК График_до1месПрошл,
	СУММА(ВЫБОР
			КОГДА ВТ_ГрафикПогашения.Период > &ДатаОтчета
					И ВТ_ГрафикПогашения.Период <= ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, 1)
				ТОГДА ВТ_ГрафикПогашения.Сумма
			ИНАЧЕ 0
		КОНЕЦ) КАК График_1МесБудущ,
	СУММА(ВЫБОР
			КОГДА ВТ_ГрафикПогашения.Период > ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, 1)
					И ВТ_ГрафикПогашения.Период <= ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, 3)
				ТОГДА ВТ_ГрафикПогашения.Сумма
			ИНАЧЕ 0
		КОНЕЦ) КАК График_3МесБудущ,
	СУММА(ВЫБОР
			КОГДА ВТ_ГрафикПогашения.Период > ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, 3)
					И ВТ_ГрафикПогашения.Период <= ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, 6)
				ТОГДА ВТ_ГрафикПогашения.Сумма
			ИНАЧЕ 0
		КОНЕЦ) КАК График_6МесБудущ,
	СУММА(ВЫБОР
			КОГДА ВТ_ГрафикПогашения.Период > ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, 6)
					И ВТ_ГрафикПогашения.Период <= ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, 12)
				ТОГДА ВТ_ГрафикПогашения.Сумма
			ИНАЧЕ 0
		КОНЕЦ) КАК График_1ГодБудущ,
	СУММА(ВЫБОР
			КОГДА ВТ_ГрафикПогашения.Период > ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, 12)
					И ВТ_ГрафикПогашения.Период <= ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, 36)
				ТОГДА ВТ_ГрафикПогашения.Сумма
			ИНАЧЕ 0
		КОНЕЦ) КАК График_1_3ГодаБудущ,
	СУММА(ВЫБОР
			КОГДА ВТ_ГрафикПогашения.Период > ДОБАВИТЬКДАТЕ(&ДатаОтчета, МЕСЯЦ, 36)
				ТОГДА ВТ_ГрафикПогашения.Сумма
			ИНАЧЕ 0
		КОНЕЦ) КАК График_Более3ЛетБудущ
ПОМЕСТИТЬ ВТ_ГрафикПогашенияПериоды
ИЗ
	ВТ_ГрафикПогашения КАК ВТ_ГрафикПогашения

СГРУППИРОВАТЬ ПО
	ВТ_ГрафикПогашения.Договор
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ХозрасчетныйОбороты.Субконто1 КАК Договор,
	СУММА(ХозрасчетныйОбороты.СуммаОборотДт) КАК ПризнаноДЗпоБУ
ПОМЕСТИТЬ ВТ_БУ_ДЗ
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Обороты(
			&НачалоНачал,
			&ДатаОтчета,
			Запись,
			Счет В ИЕРАРХИИ (&МассивСчетов),
			&СубконтоДоговоры,
			Субконто1 В
				(ВЫБРАТЬ
					ВТ_СписокДоговоров.ДоговорКонтрагента
				ИЗ
					ВТ_СписокДоговоров),
			,
			) КАК ХозрасчетныйОбороты
ГДЕ
	(НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (&МассивСчетов) )
			ИЛИ 
			ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (&МассивСчетов)
				И 
				Выбор 
					когда ХозрасчетныйОбороты.КорСубконто1 ссылка Справочник.ДоговорыКонтрагентов тогда
						ХозрасчетныйОбороты.Субконто1 <> ХозрасчетныйОбороты.КорСубконто1
					когда ХозрасчетныйОбороты.КорСубконто2 ссылка Справочник.ДоговорыКонтрагентов тогда
						ХозрасчетныйОбороты.Субконто1 <> ХозрасчетныйОбороты.КорСубконто2
					когда ХозрасчетныйОбороты.КорСубконто3 ссылка Справочник.ДоговорыКонтрагентов тогда
						ХозрасчетныйОбороты.Субконто1 <> ХозрасчетныйОбороты.КорСубконто3
				Конец
					

СГРУППИРОВАТЬ ПО
	ХозрасчетныйОбороты.Субконто1
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ГрафикПогашенияПериоды.Договор,
	ВТ_ГрафикПогашенияПериоды.График_Более3ЛетПрошл,
	ВТ_ГрафикПогашенияПериоды.График_1_3ГодаПрошл,
	ВТ_ГрафикПогашенияПериоды.График_6_12МесПрошл,
	ВТ_ГрафикПогашенияПериоды.График_3_6МесПрошл,
	ВТ_ГрафикПогашенияПериоды.График_1_3МесПрошл,
	ВТ_ГрафикПогашенияПериоды.График_до1месПрошл,
	ВТ_ГрафикПогашенияПериоды.График_1МесБудущ,
	ВТ_ГрафикПогашенияПериоды.График_3МесБудущ,
	ВТ_ГрафикПогашенияПериоды.График_6МесБудущ,
	ВТ_ГрафикПогашенияПериоды.График_1ГодБудущ,
	ВТ_ГрафикПогашенияПериоды.График_1_3ГодаБудущ,
	ВТ_ГрафикПогашенияПериоды.График_Более3ЛетБудущ,
	0 КАК ПризнаноДЗпоБУ
ПОМЕСТИТЬ ВТ_Графики_И_ДЗ
ИЗ
	ВТ_ГрафикПогашенияПериоды КАК ВТ_ГрафикПогашенияПериоды

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТ_БУ_ДЗ.Договор,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	ВТ_БУ_ДЗ.ПризнаноДЗпоБУ
ИЗ
	ВТ_БУ_ДЗ КАК ВТ_БУ_ДЗ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Графики_И_ДЗ.Договор,
	СУММА(ВТ_Графики_И_ДЗ.График_Более3ЛетПрошл) КАК График_Более3ЛетПрошл,
	СУММА(ВТ_Графики_И_ДЗ.График_1_3ГодаПрошл) КАК График_1_3ГодаПрошл,
	СУММА(ВТ_Графики_И_ДЗ.График_6_12МесПрошл) КАК График_6_12МесПрошл,
	СУММА(ВТ_Графики_И_ДЗ.График_3_6МесПрошл) КАК График_3_6МесПрошл,
	СУММА(ВТ_Графики_И_ДЗ.График_1_3МесПрошл) КАК График_1_3МесПрошл,
	СУММА(ВТ_Графики_И_ДЗ.График_до1месПрошл) КАК График_до1месПрошл,
	СУММА(ВТ_Графики_И_ДЗ.График_1МесБудущ) КАК График_1МесБудущ,
	СУММА(ВТ_Графики_И_ДЗ.График_3МесБудущ) КАК График_3МесБудущ,
	СУММА(ВТ_Графики_И_ДЗ.График_6МесБудущ) КАК График_6МесБудущ,
	СУММА(ВТ_Графики_И_ДЗ.График_1ГодБудущ) КАК График_1ГодБудущ,
	СУММА(ВТ_Графики_И_ДЗ.График_1_3ГодаБудущ) КАК График_1_3ГодаБудущ,
	СУММА(ВТ_Графики_И_ДЗ.График_Более3ЛетБудущ) КАК График_Более3ЛетБудущ,
	СУММА(ВТ_Графики_И_ДЗ.ПризнаноДЗпоБУ) КАК ПризнаноДЗпоБУ
ПОМЕСТИТЬ ВТ_ДЗ_к_Распределению
ИЗ
	ВТ_Графики_И_ДЗ КАК ВТ_Графики_И_ДЗ

СГРУППИРОВАТЬ ПО
	ВТ_Графики_И_ДЗ.Договор
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ДЗ_к_Распределению.Договор,
	ВЫБОР
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл <= ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл
		ИНАЧЕ ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
	КОНЕЦ КАК График_Более3ЛетПрошл,
	ВЫБОР
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл <= ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл < ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ - ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл
		ИНАЧЕ 0
	КОНЕЦ КАК График_1_3ГодаПрошл,
	ВЫБОР
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл <= ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.График_6_12МесПрошл
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл < ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ - (ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл)
		ИНАЧЕ 0
	КОНЕЦ КАК График_6_12МесПрошл,
	ВЫБОР
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл <= ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.График_3_6МесПрошл
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл < ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ - (ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл)
		ИНАЧЕ 0
	КОНЕЦ КАК График_3_6МесПрошл,
	ВЫБОР
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл <= ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.График_1_3МесПрошл
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл < ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ - (ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл)
		ИНАЧЕ 0
	КОНЕЦ КАК График_1_3МесПрошл,
	ВЫБОР
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл <= ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.График_до1месПрошл
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл < ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ - (ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл)
		ИНАЧЕ 0
	КОНЕЦ КАК График_до1месПрошл,
	ВЫБОР
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ <= ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.График_1МесБудущ
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл < ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ - (ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл)
		ИНАЧЕ 0
	КОНЕЦ КАК График_1МесБудущ,
	ВЫБОР
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ + ВТ_ДЗ_к_Распределению.График_3МесБудущ <= ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.График_3МесБудущ
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ < ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ - (ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ)
		ИНАЧЕ 0
	КОНЕЦ КАК График_3МесБудущ,
	ВЫБОР
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ + ВТ_ДЗ_к_Распределению.График_3МесБудущ + ВТ_ДЗ_к_Распределению.График_6МесБудущ <= ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.График_6МесБудущ
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ + ВТ_ДЗ_к_Распределению.График_3МесБудущ < ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ - (ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ + ВТ_ДЗ_к_Распределению.График_3МесБудущ)
		ИНАЧЕ 0
	КОНЕЦ КАК График_6МесБудущ,
	ВЫБОР
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ + ВТ_ДЗ_к_Распределению.График_3МесБудущ + ВТ_ДЗ_к_Распределению.График_6МесБудущ + ВТ_ДЗ_к_Распределению.График_1ГодБудущ <= ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.График_1ГодБудущ
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ + ВТ_ДЗ_к_Распределению.График_3МесБудущ + ВТ_ДЗ_к_Распределению.График_6МесБудущ < ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ - (ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ + ВТ_ДЗ_к_Распределению.График_3МесБудущ + ВТ_ДЗ_к_Распределению.График_6МесБудущ)
		ИНАЧЕ 0
	КОНЕЦ КАК График_1ГодБудущ,
	ВЫБОР
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ + ВТ_ДЗ_к_Распределению.График_3МесБудущ + ВТ_ДЗ_к_Распределению.График_6МесБудущ + ВТ_ДЗ_к_Распределению.График_1ГодБудущ + ВТ_ДЗ_к_Распределению.График_1_3ГодаБудущ <= ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.График_1_3ГодаБудущ
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ + ВТ_ДЗ_к_Распределению.График_3МесБудущ + ВТ_ДЗ_к_Распределению.График_6МесБудущ + ВТ_ДЗ_к_Распределению.График_1ГодБудущ < ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ - (ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ + ВТ_ДЗ_к_Распределению.График_3МесБудущ + ВТ_ДЗ_к_Распределению.График_6МесБудущ + ВТ_ДЗ_к_Распределению.График_1ГодБудущ)
		ИНАЧЕ 0
	КОНЕЦ КАК График_1_3ГодаБудущ,
	ВЫБОР
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ + ВТ_ДЗ_к_Распределению.График_3МесБудущ + ВТ_ДЗ_к_Распределению.График_6МесБудущ + ВТ_ДЗ_к_Распределению.График_1ГодБудущ + ВТ_ДЗ_к_Распределению.График_1_3ГодаБудущ + ВТ_ДЗ_к_Распределению.График_Более3ЛетБудущ <= ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетБудущ
		КОГДА ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ + ВТ_ДЗ_к_Распределению.График_3МесБудущ + ВТ_ДЗ_к_Распределению.График_6МесБудущ + ВТ_ДЗ_к_Распределению.График_1ГодБудущ + ВТ_ДЗ_к_Распределению.График_1_3ГодаБудущ < ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
			ТОГДА ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ - (ВТ_ДЗ_к_Распределению.График_Более3ЛетПрошл + ВТ_ДЗ_к_Распределению.График_1_3ГодаПрошл + ВТ_ДЗ_к_Распределению.График_6_12МесПрошл + ВТ_ДЗ_к_Распределению.График_3_6МесПрошл + ВТ_ДЗ_к_Распределению.График_1_3МесПрошл + ВТ_ДЗ_к_Распределению.График_до1месПрошл + ВТ_ДЗ_к_Распределению.График_1МесБудущ + ВТ_ДЗ_к_Распределению.График_3МесБудущ + ВТ_ДЗ_к_Распределению.График_6МесБудущ + ВТ_ДЗ_к_Распределению.График_1ГодБудущ + ВТ_ДЗ_к_Распределению.График_1_3ГодаБудущ)
		ИНАЧЕ 0
	КОНЕЦ КАК График_Более3ЛетБудущ,
	ВТ_ДЗ_к_Распределению.ПризнаноДЗпоБУ
ПОМЕСТИТЬ ВТ_ГрафикFIFO
ИЗ
	ВТ_ДЗ_к_Распределению КАК ВТ_ДЗ_к_Распределению
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ГрафикFIFO.Договор,
	ВТ_ГрафикFIFO.График_Более3ЛетПрошл,
	ВТ_ГрафикFIFO.График_1_3ГодаПрошл,
	ВТ_ГрафикFIFO.График_6_12МесПрошл,
	ВТ_ГрафикFIFO.График_3_6МесПрошл,
	ВТ_ГрафикFIFO.График_1_3МесПрошл,
	ВТ_ГрафикFIFO.График_до1месПрошл,
	ВТ_ГрафикFIFO.График_1МесБудущ,
	ВТ_ГрафикFIFO.График_3МесБудущ,
	ВТ_ГрафикFIFO.График_6МесБудущ,
	ВТ_ГрафикFIFO.График_1ГодБудущ,
	ВТ_ГрафикFIFO.График_1_3ГодаБудущ,
	ВТ_ГрафикFIFO.График_Более3ЛетБудущ,
	ВТ_ГрафикFIFO.График_Более3ЛетПрошл + ВТ_ГрафикFIFO.График_1_3ГодаПрошл + ВТ_ГрафикFIFO.График_6_12МесПрошл + ВТ_ГрафикFIFO.График_3_6МесПрошл + ВТ_ГрафикFIFO.График_1_3МесПрошл + ВТ_ГрафикFIFO.График_до1месПрошл + ВТ_ГрафикFIFO.График_1МесБудущ + ВТ_ГрафикFIFO.График_3МесБудущ + ВТ_ГрафикFIFO.График_6МесБудущ + ВТ_ГрафикFIFO.График_1ГодБудущ + ВТ_ГрафикFIFO.График_1_3ГодаБудущ + ВТ_ГрафикFIFO.График_Более3ЛетБудущ КАК ИтогоДЗПоГраффикуFIFO,
	ВТ_ГрафикFIFO.ПризнаноДЗпоБУ - (ВТ_ГрафикFIFO.График_Более3ЛетПрошл + ВТ_ГрафикFIFO.График_1_3ГодаПрошл + ВТ_ГрафикFIFO.График_6_12МесПрошл + ВТ_ГрафикFIFO.График_3_6МесПрошл + ВТ_ГрафикFIFO.График_1_3МесПрошл + ВТ_ГрафикFIFO.График_до1месПрошл + ВТ_ГрафикFIFO.График_1МесБудущ + ВТ_ГрафикFIFO.График_3МесБудущ + ВТ_ГрафикFIFO.График_6МесБудущ + ВТ_ГрафикFIFO.График_1ГодБудущ + ВТ_ГрафикFIFO.График_1_3ГодаБудущ + ВТ_ГрафикFIFO.График_Более3ЛетБудущ) КАК ОстатокДЗНеРаспределенный,
	ВТ_ГрафикFIFO.ПризнаноДЗпоБУ
ПОМЕСТИТЬ ВТ_ГрафикFIFO_Final
ИЗ
	ВТ_ГрафикFIFO КАК ВТ_ГрафикFIFO
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ХозрасчетныйОбороты.Субконто1 КАК Договор,
	СУММА(ХозрасчетныйОбороты.СуммаОборотКт) КАК ВсегоПогашеноБУ
ПОМЕСТИТЬ ВТ_Погашено
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Обороты(
			&НачалоНачал,
			&ДатаОтчета,
			Запись,
			Счет В ИЕРАРХИИ (&МассивСчетов),
			&СубконтоДоговоры,
			Субконто1 В
				(ВЫБРАТЬ
					ВТ_СписокДоговоров.ДоговорКонтрагента
				ИЗ
					ВТ_СписокДоговоров),
			,
			) КАК ХозрасчетныйОбороты
ГДЕ
	(НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (&МассивСчетов) )
			ИЛИ 
			ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (&МассивСчетов)
				И 
				Выбор 
					когда ХозрасчетныйОбороты.КорСубконто1 ссылка Справочник.ДоговорыКонтрагентов тогда
						ХозрасчетныйОбороты.Субконто1 <> ХозрасчетныйОбороты.КорСубконто1
					когда ХозрасчетныйОбороты.КорСубконто2 ссылка Справочник.ДоговорыКонтрагентов тогда
						ХозрасчетныйОбороты.Субконто1 <> ХозрасчетныйОбороты.КорСубконто2
					когда ХозрасчетныйОбороты.КорСубконто3 ссылка Справочник.ДоговорыКонтрагентов тогда
						ХозрасчетныйОбороты.Субконто1 <> ХозрасчетныйОбороты.КорСубконто3
				Конец


СГРУППИРОВАТЬ ПО
	ХозрасчетныйОбороты.Субконто1
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ГрафикFIFO_Final.Договор,
	ВТ_ГрафикFIFO_Final.График_Более3ЛетПрошл,
	ВТ_ГрафикFIFO_Final.График_1_3ГодаПрошл,
	ВТ_ГрафикFIFO_Final.График_6_12МесПрошл,
	ВТ_ГрафикFIFO_Final.График_3_6МесПрошл,
	ВТ_ГрафикFIFO_Final.График_1_3МесПрошл,
	ВТ_ГрафикFIFO_Final.График_до1месПрошл,
	ВТ_ГрафикFIFO_Final.График_1МесБудущ,
	ВТ_ГрафикFIFO_Final.График_3МесБудущ,
	ВТ_ГрафикFIFO_Final.График_6МесБудущ,
	ВТ_ГрафикFIFO_Final.График_1ГодБудущ,
	ВТ_ГрафикFIFO_Final.График_1_3ГодаБудущ,
	ВТ_ГрафикFIFO_Final.График_Более3ЛетБудущ,
	ВТ_ГрафикFIFO_Final.ИтогоДЗПоГраффикуFIFO,
	ВТ_ГрафикFIFO_Final.ОстатокДЗНеРаспределенный,
	ВТ_ГрафикFIFO_Final.ПризнаноДЗпоБУ,
	0 КАК ВсегоПогашеноБУ
ПОМЕСТИТЬ ВТ_Общая
ИЗ
	ВТ_ГрафикFIFO_Final КАК ВТ_ГрафикFIFO_Final

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТ_Погашено.Договор,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	ВТ_Погашено.ВсегоПогашеноБУ
ИЗ
	ВТ_Погашено КАК ВТ_Погашено
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Общая.Договор,
	СУММА(ВТ_Общая.График_Более3ЛетПрошл) КАК График_Более3ЛетПрошл,
	СУММА(ВТ_Общая.График_1_3ГодаПрошл) КАК График_1_3ГодаПрошл,
	СУММА(ВТ_Общая.График_6_12МесПрошл) КАК График_6_12МесПрошл,
	СУММА(ВТ_Общая.График_3_6МесПрошл) КАК График_3_6МесПрошл,
	СУММА(ВТ_Общая.График_1_3МесПрошл) КАК График_1_3МесПрошл,
	СУММА(ВТ_Общая.График_до1месПрошл) КАК График_до1месПрошл,
	СУММА(ВТ_Общая.График_1МесБудущ) КАК График_1МесБудущ,
	СУММА(ВТ_Общая.График_3МесБудущ) КАК График_3МесБудущ,
	СУММА(ВТ_Общая.График_6МесБудущ) КАК График_6МесБудущ,
	СУММА(ВТ_Общая.График_1ГодБудущ) КАК График_1ГодБудущ,
	СУММА(ВТ_Общая.График_1_3ГодаБудущ) КАК График_1_3ГодаБудущ,
	СУММА(ВТ_Общая.График_Более3ЛетБудущ) КАК График_Более3ЛетБудущ,
	СУММА(ВТ_Общая.ИтогоДЗПоГраффикуFIFO) КАК ИтогоДЗПоГраффикуFIFO,
	СУММА(ВТ_Общая.ПризнаноДЗпоБУ) КАК ПризнаноДЗпоБУ,
	СУММА(ВТ_Общая.ОстатокДЗНеРаспределенный) КАК ОстатокДЗНеРаспределенный,
	СУММА(ВТ_Общая.ВсегоПогашеноБУ) КАК ВсегоПогашеноБУ
ПОМЕСТИТЬ ВТ_Данные
ИЗ
	ВТ_Общая КАК ВТ_Общая

СГРУППИРОВАТЬ ПО
	ВТ_Общая.Договор
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Данные.Договор,
	ВЫБОР
		КОГДА ВТ_Данные.График_Более3ЛетПрошл < ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА 0
		ИНАЧЕ ВТ_Данные.График_Более3ЛетПрошл - ВТ_Данные.ВсегоПогашеноБУ
	КОНЕЦ КАК График_Более3ЛетПрошл,
	ВЫБОР
		КОГДА ВТ_Данные.График_Более3ЛетПрошл >= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА ВТ_Данные.График_1_3ГодаПрошл
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл <= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА 0
		ИНАЧЕ ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл - ВТ_Данные.ВсегоПогашеноБУ
	КОНЕЦ КАК График_1_3ГодаПрошл,
	ВЫБОР
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл >= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА ВТ_Данные.График_6_12МесПрошл
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл <= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА 0
		ИНАЧЕ ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл - ВТ_Данные.ВсегоПогашеноБУ
	КОНЕЦ КАК График_6_12МесПрошл,
	ВЫБОР
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл >= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА ВТ_Данные.График_3_6МесПрошл
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл <= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА 0
		ИНАЧЕ ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл - ВТ_Данные.ВсегоПогашеноБУ
	КОНЕЦ КАК График_3_6МесПрошл,
	ВЫБОР
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл >= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА ВТ_Данные.График_1_3МесПрошл
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл <= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА 0
		ИНАЧЕ ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл - ВТ_Данные.ВсегоПогашеноБУ
	КОНЕЦ КАК График_1_3МесПрошл,
	ВЫБОР
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл >= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА ВТ_Данные.График_до1месПрошл
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл <= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА 0
		ИНАЧЕ ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл - ВТ_Данные.ВсегоПогашеноБУ
	КОНЕЦ КАК График_до1месПрошл,
	ВЫБОР
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл >= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА ВТ_Данные.График_1МесБудущ
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ <= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА 0
		ИНАЧЕ ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ - ВТ_Данные.ВсегоПогашеноБУ
	КОНЕЦ КАК График_1МесБудущ,
	ВЫБОР
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ >= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА ВТ_Данные.График_3МесБудущ
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ <= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА 0
		ИНАЧЕ ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ - ВТ_Данные.ВсегоПогашеноБУ
	КОНЕЦ КАК График_3МесБудущ,
	ВЫБОР
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ >= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА ВТ_Данные.График_6МесБудущ
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ + ВТ_Данные.График_6МесБудущ <= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА 0
		ИНАЧЕ ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ + ВТ_Данные.График_6МесБудущ - ВТ_Данные.ВсегоПогашеноБУ
	КОНЕЦ КАК График_6МесБудущ,
	ВЫБОР
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ + ВТ_Данные.График_6МесБудущ >= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА ВТ_Данные.График_1ГодБудущ
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ + ВТ_Данные.График_6МесБудущ + ВТ_Данные.График_1ГодБудущ <= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА 0
		ИНАЧЕ ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ + ВТ_Данные.График_6МесБудущ + ВТ_Данные.График_1ГодБудущ - ВТ_Данные.ВсегоПогашеноБУ
	КОНЕЦ КАК График_1ГодБудущ,
	ВЫБОР
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ + ВТ_Данные.График_6МесБудущ + ВТ_Данные.График_1ГодБудущ >= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА ВТ_Данные.График_1_3ГодаБудущ
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ + ВТ_Данные.График_6МесБудущ + ВТ_Данные.График_1ГодБудущ + ВТ_Данные.График_1_3ГодаБудущ <= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА 0
		ИНАЧЕ ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ + ВТ_Данные.График_6МесБудущ + ВТ_Данные.График_1ГодБудущ + ВТ_Данные.График_1_3ГодаБудущ - ВТ_Данные.ВсегоПогашеноБУ
	КОНЕЦ КАК График_1_3ГодаБудущ,
	ВЫБОР
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ + ВТ_Данные.График_6МесБудущ + ВТ_Данные.График_1ГодБудущ + ВТ_Данные.График_1_3ГодаБудущ >= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА ВТ_Данные.График_Более3ЛетБудущ
		КОГДА ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ + ВТ_Данные.График_6МесБудущ + ВТ_Данные.График_1ГодБудущ + ВТ_Данные.График_1_3ГодаБудущ + ВТ_Данные.График_Более3ЛетБудущ <= ВТ_Данные.ВсегоПогашеноБУ
			ТОГДА 0
		ИНАЧЕ ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ + ВТ_Данные.График_6МесБудущ + ВТ_Данные.График_1ГодБудущ + ВТ_Данные.График_1_3ГодаБудущ + ВТ_Данные.График_Более3ЛетБудущ - ВТ_Данные.ВсегоПогашеноБУ
	КОНЕЦ КАК График_Более3ЛетБудущ,
	ВТ_Данные.ОстатокДЗНеРаспределенный,
	ВЫБОР
		КОГДА ВТ_Данные.ВсегоПогашеноБУ > ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ + ВТ_Данные.График_6МесБудущ + ВТ_Данные.График_1ГодБудущ + ВТ_Данные.График_1_3ГодаБудущ + ВТ_Данные.График_Более3ЛетБудущ
			ТОГДА ВТ_Данные.ВсегоПогашеноБУ - (ВТ_Данные.График_Более3ЛетПрошл + ВТ_Данные.График_1_3ГодаПрошл + ВТ_Данные.График_6_12МесПрошл + ВТ_Данные.График_3_6МесПрошл + ВТ_Данные.График_1_3МесПрошл + ВТ_Данные.График_до1месПрошл + ВТ_Данные.График_1МесБудущ + ВТ_Данные.График_3МесБудущ + ВТ_Данные.График_6МесБудущ + ВТ_Данные.График_1ГодБудущ + ВТ_Данные.График_1_3ГодаБудущ + ВТ_Данные.График_Более3ЛетБудущ)
		ИНАЧЕ 0
	КОНЕЦ КАК ОстатокПлатежейНеРаспределенный,
	ВТ_Данные.ИтогоДЗПоГраффикуFIFO,
	ВТ_Данные.ПризнаноДЗпоБУ,
	ВТ_Данные.ВсегоПогашеноБУ
ПОМЕСТИТЬ ВТ_ДЗ_Расчет
ИЗ
	ВТ_Данные КАК ВТ_Данные
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТИТОГ.Договор,
	СУММА(ВТИТОГ.График_Более3ЛетПрошл) КАК График_Более3ЛетПрошл,
	СУММА(ВТИТОГ.График_1_3ГодаПрошл) КАК График_1_3ГодаПрошл,
	СУММА(ВТИТОГ.График_6_12МесПрошл) КАК График_6_12МесПрошл,
	СУММА(ВТИТОГ.График_3_6МесПрошл) КАК График_3_6МесПрошл,
	СУММА(ВТИТОГ.График_1_3МесПрошл) КАК График_1_3МесПрошл,
	СУММА(ВТИТОГ.График_до1месПрошл) КАК График_до1месПрошл,
	СУММА(ВТИТОГ.График_1МесБудущ) КАК График_1МесБудущ,
	СУММА(ВТИТОГ.График_3МесБудущ) КАК График_3МесБудущ,
	СУММА(ВТИТОГ.График_6МесБудущ) КАК График_6МесБудущ,
	СУММА(ВТИТОГ.График_1ГодБудущ) КАК График_1ГодБудущ,
	СУММА(ВТИТОГ.График_1_3ГодаБудущ) КАК График_1_3ГодаБудущ,
	СУММА(ВТИТОГ.График_Более3ЛетБудущ) КАК График_Более3ЛетБудущ,
	СУММА(ВТИТОГ.ИтогоОстатокДЗПоПериодам) КАК ИтогоОстатокДЗПоПериодам,
	СУММА(ВТИТОГ.ИтогоДЗПоГраффикуFIFO) КАК ИтогоДЗПоГраффикуFIFO,
	СУММА(ВТИТОГ.ПризнаноДЗпоБУ) КАК ПризнаноДЗпоБУ,
	СУММА(ВТИТОГ.ВсегоПогашеноБУ) КАК ВсегоПогашеноБУ,
	СУММА(ВТИТОГ.Сальдо_ДЗ_БУ_НаДатуОтчета) КАК Сальдо_ДЗ_БУ_НаДатуОтчета,
	СУММА(ВТИТОГ.ОстатокДЗНеРаспределенный) КАК ОстатокДЗНеРаспределенный,
	СУММА(ВТИТОГ.ОстатокПлатежейНеРаспределенный) КАК ОстатокПлатежейНеРаспределенный,
	ОКР(СУММА(ВТИТОГ.ИтогоДЗПоГраффикуFIFO), 2) = ОКР(СУММА(ВТИТОГ.ПризнаноДЗпоБУ), 2) КАК СоответствиеПризнанияДЗвБУиГрафикаПоFIFO,
	СУММА(ВТИТОГ.ВсегоПогашеноБУ) <= СУММА(ВТИТОГ.ИтогоДЗПоГраффикуFIFO) КАК ПоступленияНеПревышаютГрафик
ПОМЕСТИТЬ ВТ_Итог
ИЗ
	(ВЫБРАТЬ
		ВТ_ДЗ_Расчет.Договор КАК Договор,
		ВТ_ДЗ_Расчет.График_Более3ЛетПрошл КАК График_Более3ЛетПрошл,
		ВТ_ДЗ_Расчет.График_1_3ГодаПрошл КАК График_1_3ГодаПрошл,
		ВТ_ДЗ_Расчет.График_6_12МесПрошл КАК График_6_12МесПрошл,
		ВТ_ДЗ_Расчет.График_3_6МесПрошл КАК График_3_6МесПрошл,
		ВТ_ДЗ_Расчет.График_1_3МесПрошл КАК График_1_3МесПрошл,
		ВТ_ДЗ_Расчет.График_до1месПрошл КАК График_до1месПрошл,
		ВТ_ДЗ_Расчет.График_1МесБудущ КАК График_1МесБудущ,
		ВТ_ДЗ_Расчет.График_3МесБудущ КАК График_3МесБудущ,
		ВТ_ДЗ_Расчет.График_6МесБудущ КАК График_6МесБудущ,
		ВТ_ДЗ_Расчет.График_1ГодБудущ КАК График_1ГодБудущ,
		ВТ_ДЗ_Расчет.График_1_3ГодаБудущ КАК График_1_3ГодаБудущ,
		ВТ_ДЗ_Расчет.График_Более3ЛетБудущ КАК График_Более3ЛетБудущ,
		ВТ_ДЗ_Расчет.График_Более3ЛетПрошл + ВТ_ДЗ_Расчет.График_1_3ГодаПрошл + ВТ_ДЗ_Расчет.График_6_12МесПрошл + ВТ_ДЗ_Расчет.График_3_6МесПрошл + ВТ_ДЗ_Расчет.График_1_3МесПрошл + ВТ_ДЗ_Расчет.График_до1месПрошл + ВТ_ДЗ_Расчет.График_1МесБудущ + ВТ_ДЗ_Расчет.График_3МесБудущ + ВТ_ДЗ_Расчет.График_6МесБудущ + ВТ_ДЗ_Расчет.График_1ГодБудущ + ВТ_ДЗ_Расчет.График_1_3ГодаБудущ + ВТ_ДЗ_Расчет.График_Более3ЛетБудущ КАК ИтогоОстатокДЗПоПериодам,
		ВТ_ДЗ_Расчет.ИтогоДЗПоГраффикуFIFO КАК ИтогоДЗПоГраффикуFIFO,
		ВТ_ДЗ_Расчет.ПризнаноДЗпоБУ КАК ПризнаноДЗпоБУ,
		ВТ_ДЗ_Расчет.ОстатокДЗНеРаспределенный КАК ОстатокДЗНеРаспределенный,
		ВТ_ДЗ_Расчет.ОстатокПлатежейНеРаспределенный КАК ОстатокПлатежейНеРаспределенный,
		ВТ_ДЗ_Расчет.ВсегоПогашеноБУ КАК ВсегоПогашеноБУ,
		0 КАК Сальдо_ДЗ_БУ_НаДатуОтчета
	ИЗ
		ВТ_ДЗ_Расчет КАК ВТ_ДЗ_Расчет
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ХозрасчетныйОстатки.Субконто1,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		ЕСТЬNULL(ХозрасчетныйОстатки.СуммаОстатокДт, 0)
	ИЗ
		РегистрБухгалтерии.Хозрасчетный.Остатки(
				{(&ДатаОтчета)},
				Счет В ИЕРАРХИИ (&МассивСчетов),
				&СубконтоДоговоры,
				Субконто1 В
					(ВЫБРАТЬ
						ВТ_СписокДоговоров.ДоговорКонтрагента
					ИЗ
						ВТ_СписокДоговоров)) КАК ХозрасчетныйОстатки) КАК ВТИТОГ

СГРУППИРОВАТЬ ПО
	ВТИТОГ.Договор
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Итог.Договор,
	ВТ_Итог.График_Более3ЛетПрошл,
	ВТ_Итог.График_1_3ГодаПрошл,
	ВТ_Итог.График_6_12МесПрошл,
	ВТ_Итог.График_3_6МесПрошл,
	ВТ_Итог.График_1_3МесПрошл,
	ВТ_Итог.График_до1месПрошл,
	ВТ_Итог.График_Более3ЛетПрошл + ВТ_Итог.График_1_3ГодаПрошл + ВТ_Итог.График_6_12МесПрошл + ВТ_Итог.График_3_6МесПрошл + ВТ_Итог.График_1_3МесПрошл + ВТ_Итог.График_до1месПрошл КАК ВсегоПросроченная,
	ВТ_Итог.График_1МесБудущ,
	ВТ_Итог.График_3МесБудущ,
	ВТ_Итог.График_6МесБудущ,
	ВТ_Итог.График_1ГодБудущ,
	ВТ_Итог.График_1_3ГодаБудущ,
	ВТ_Итог.График_Более3ЛетБудущ,
	ВТ_Итог.График_1МесБудущ + ВТ_Итог.График_3МесБудущ + ВТ_Итог.График_6МесБудущ + ВТ_Итог.График_1ГодБудущ + ВТ_Итог.График_1_3ГодаБудущ + ВТ_Итог.График_Более3ЛетБудущ КАК ВсегоТекущая,
	ВТ_Итог.ИтогоОстатокДЗПоПериодам,
	ВТ_Итог.ИтогоДЗПоГраффикуFIFO,
	ВТ_Итог.ПризнаноДЗпоБУ,
	ВТ_Итог.ВсегоПогашеноБУ,
	ВТ_Итог.Сальдо_ДЗ_БУ_НаДатуОтчета,
	ВТ_Итог.СоответствиеПризнанияДЗвБУиГрафикаПоFIFO,
	ВТ_Итог.ПоступленияНеПревышаютГрафик,
	ВТ_Итог.ОстатокДЗНеРаспределенный,
	ВТ_Итог.ОстатокПлатежейНеРаспределенный,
	ВТ_Итог.ОстатокДЗНеРаспределенный - ВТ_Итог.ОстатокПлатежейНеРаспределенный КАК СальдоНераспределенное,
	ЕСТЬNULL(ВТ_ГрафикНачисления.Сумма, 0) КАК ИтогоПризнаноПоГрафикуНачислений,
	ЕСТЬNULL(ВТ_ГрафикНачисления.Сумма, 0) = ВТ_Итог.ПризнаноДЗпоБУ КАК СоответствиеНачисленийПоГрафикуИРаспределеннойДЗпоFIFO,
	ОКР(ВТ_Итог.ИтогоОстатокДЗПоПериодам, 2) = ОКР(ВТ_Итог.Сальдо_ДЗ_БУ_НаДатуОтчета, 2) КАК РасчетнаяДЗРавнаСальдоПоБУ
ПОМЕСТИТЬ ИТОГ1
ИЗ
	ВТ_Итог КАК ВТ_Итог
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ГрафикНачисления КАК ВТ_ГрафикНачисления
		ПО (ВТ_ГрафикНачисления.Договор = ВТ_Итог.Договор)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ИТОГ1.Договор,
	ИТОГ1.График_Более3ЛетПрошл,
	ИТОГ1.График_1_3ГодаПрошл,
	ИТОГ1.График_6_12МесПрошл,
	ИТОГ1.График_3_6МесПрошл,
	ИТОГ1.График_1_3МесПрошл,
	ИТОГ1.График_до1месПрошл,
	ИТОГ1.ВсегоПросроченная,
	ИТОГ1.График_1МесБудущ,
	ИТОГ1.График_3МесБудущ,
	ИТОГ1.График_6МесБудущ,
	ИТОГ1.График_1ГодБудущ,
	ИТОГ1.График_1_3ГодаБудущ,
	ИТОГ1.График_Более3ЛетБудущ,
	ИТОГ1.ВсегоТекущая,
	ИТОГ1.ИтогоОстатокДЗПоПериодам,
	ИТОГ1.ИтогоДЗПоГраффикуFIFO,
	ИТОГ1.ПризнаноДЗпоБУ,
	ИТОГ1.ВсегоПогашеноБУ,
	ИТОГ1.Сальдо_ДЗ_БУ_НаДатуОтчета,
	ИТОГ1.ИтогоПризнаноПоГрафикуНачислений,
	ИТОГ1.СоответствиеПризнанияДЗвБУиГрафикаПоFIFO,
	ИТОГ1.ПоступленияНеПревышаютГрафик,
	ИТОГ1.РасчетнаяДЗРавнаСальдоПоБУ,
	ИТОГ1.ОстатокДЗНеРаспределенный,
	ИТОГ1.ОстатокПлатежейНеРаспределенный,
	ИТОГ1.СальдоНераспределенное,
	ИТОГ1.СоответствиеНачисленийПоГрафикуИРаспределеннойДЗпоFIFO,
	ВЫБОР
		КОГДА ИТОГ1.График_Более3ЛетПрошл < 0
				ИЛИ ИТОГ1.График_1_3ГодаПрошл < 0
				ИЛИ ИТОГ1.График_6_12МесПрошл < 0
				ИЛИ ИТОГ1.График_3_6МесПрошл < 0
				ИЛИ ИТОГ1.График_1_3МесПрошл < 0
				ИЛИ ИТОГ1.График_до1месПрошл < 0
				ИЛИ ИТОГ1.График_1МесБудущ < 0
				ИЛИ ИТОГ1.График_3МесБудущ < 0
				ИЛИ ИТОГ1.График_6МесБудущ < 0
				ИЛИ ИТОГ1.График_1ГодБудущ < 0
				ИЛИ ИТОГ1.График_1_3ГодаБудущ < 0
				ИЛИ ИТОГ1.График_Более3ЛетБудущ < 0
				ИЛИ ИТОГ1.ОстатокДЗНеРаспределенный < 0
				ИЛИ ИТОГ1.ОстатокПлатежейНеРаспределенный < 0
				ИЛИ ИТОГ1.СальдоНераспределенное < 0
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК Ошибка
ПОМЕСТИТЬ ИТОГ2
ИЗ
	ИТОГ1 КАК ИТОГ1
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ИТОГ2.Договор,
	ВЫБОР
		КОГДА ИТОГ2.Ошибка
			ТОГДА 0
		ИНАЧЕ ИТОГ2.График_Более3ЛетПрошл
	КОНЕЦ КАК График_Более3ЛетПрошл,
	ВЫБОР
		КОГДА ИТОГ2.Ошибка
			ТОГДА 0
		ИНАЧЕ ИТОГ2.График_1_3ГодаПрошл
	КОНЕЦ КАК График_1_3ГодаПрошл,
	ВЫБОР
		КОГДА ИТОГ2.Ошибка
			ТОГДА 0
		ИНАЧЕ ИТОГ2.График_6_12МесПрошл
	КОНЕЦ КАК График_6_12МесПрошл,
	ВЫБОР
		КОГДА ИТОГ2.Ошибка
			ТОГДА 0
		ИНАЧЕ ИТОГ2.График_3_6МесПрошл
	КОНЕЦ КАК График_3_6МесПрошл,
	ВЫБОР
		КОГДА ИТОГ2.Ошибка
			ТОГДА 0
		ИНАЧЕ ИТОГ2.График_1_3МесПрошл
	КОНЕЦ КАК График_1_3МесПрошл,
	ВЫБОР
		КОГДА ИТОГ2.Ошибка
			ТОГДА 0
		ИНАЧЕ ИТОГ2.График_до1месПрошл
	КОНЕЦ КАК График_до1месПрошл,
	ВЫБОР
		КОГДА ИТОГ2.Ошибка
			ТОГДА 0
		ИНАЧЕ ИТОГ2.ВсегоПросроченная
	КОНЕЦ КАК ВсегоПросроченная,
	ВЫБОР
		КОГДА ИТОГ2.Ошибка
			ТОГДА 0
		ИНАЧЕ ИТОГ2.График_1МесБудущ
	КОНЕЦ КАК График_1МесБудущ,
	ВЫБОР
		КОГДА ИТОГ2.Ошибка
			ТОГДА 0
		ИНАЧЕ ИТОГ2.График_3МесБудущ
	КОНЕЦ КАК График_3МесБудущ,
	ВЫБОР
		КОГДА ИТОГ2.Ошибка
			ТОГДА 0
		ИНАЧЕ ИТОГ2.График_6МесБудущ
	КОНЕЦ КАК График_6МесБудущ,
	ВЫБОР
		КОГДА ИТОГ2.Ошибка
			ТОГДА 0
		ИНАЧЕ ИТОГ2.График_1ГодБудущ
	КОНЕЦ КАК График_1ГодБудущ,
	ВЫБОР
		КОГДА ИТОГ2.Ошибка
			ТОГДА 0
		ИНАЧЕ ИТОГ2.График_1_3ГодаБудущ
	КОНЕЦ КАК График_1_3ГодаБудущ,
	ВЫБОР
		КОГДА ИТОГ2.Ошибка
			ТОГДА 0
		ИНАЧЕ ИТОГ2.График_Более3ЛетБудущ
	КОНЕЦ КАК График_Более3ЛетБудущ,
	ВЫБОР
		КОГДА ИТОГ2.Ошибка
			ТОГДА 0
		ИНАЧЕ ИТОГ2.ВсегоТекущая
	КОНЕЦ КАК ВсегоТекущая,
	ИТОГ2.ИтогоОстатокДЗПоПериодам,
	ИТОГ2.ИтогоДЗПоГраффикуFIFO,
	ИТОГ2.ПризнаноДЗпоБУ,
	ИТОГ2.ВсегоПогашеноБУ,
	ИТОГ2.Сальдо_ДЗ_БУ_НаДатуОтчета,
	ИТОГ2.ОстатокДЗНеРаспределенный,
	ИТОГ2.ОстатокПлатежейНеРаспределенный,
	ИТОГ2.СальдоНераспределенное,
	ИТОГ2.СоответствиеПризнанияДЗвБУиГрафикаПоFIFO,
	ИТОГ2.ПоступленияНеПревышаютГрафик,
	ИТОГ2.РасчетнаяДЗРавнаСальдоПоБУ,
	ИТОГ2.ИтогоПризнаноПоГрафикуНачислений,
	ИТОГ2.СоответствиеНачисленийПоГрафикуИРаспределеннойДЗпоFIFO,
	ИТОГ2.Ошибка
ИЗ
	ИТОГ2 КАК ИТОГ2
